<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi" />

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300&display=swap" rel="stylesheet">

        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <!-- fontawesome -->
        <script src="https://kit.fontawesome.com/f01f0fc428.js" crossorigin="anonymous"></script>

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

        <title>For Kristin</title>
        <link rel="icon" type="image/x-icon" href="https://iconarchive.com/download/i66645/designbolts/free-valentine-heart/Heart.ico">

        <style type="text/css">
            * {
                text-align: center;
                font-family: 'Quicksand', Helvetica, sans-serif;
            }
            body {
                height: 100vh;
                background: rgb(146,255,221);
                background: linear-gradient(0deg, rgba(146,255,221,1) 0%, rgba(43,165,255,1) 100%);
            }
            button {
                width: 100%;
                color: white !important;
                background-color: #0078d2 !important;
            }
            a {
                text-decoration: none;
                color: #0078d2;
            }
            #filters-btn {
                color: white;
                text-align: right;
                padding: 20px;
            }
            #subtitle {
                color: white;
                text-shadow: 0px 0px 5px #0078d2;
                width: 100%;
                position: absolute;
                top: 25%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
            }
            #randomize-btn {
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
                width: 300px;
                height: 300px;
                background-color: #0078d2;
                border-radius: 100%;
                box-shadow: 0px 0px 40px #0078d2;
            }
            #randomize-btn:active {
                filter: brightness(0.8);
            }
            #randomize-btn img {
                height: 80%;
            }
            #resultHolder {
                color: white;
                padding-top: 100px;
            }
            #startupModal .modal-dialog {
                top: 20%;
            }
            #filtersModal .btn-group-toggle {
                text-align: left;
            }
            .filter-header {
                display: flex;
                justify-content: space-between;
            }
            .btn-filter, .btn-filter:hover {
                color: #aaa;
                background-color: white;
                border-color: #aaa;
                margin: 5px;
            }
            .btn-filter.active {
                color: white;
                background-color: #0078d2;
                border-color: #0078d2;
            }
            .btn-filter input{
                display: none;
            }
        </style>

        <script type="text/javascript">
            var list = [];
            list.push({'name':'Sushi Diner', 'location': 'Mesa College', 'cuisine': 'Japanese'});
            list.push({'name':'Homestyle Hawaiian', 'location': 'Mesa College', 'cuisine': 'Hawaiian'});
            list.push({'name':'Domino\'s Pizza', 'location': 'Mesa College', 'cuisine': 'American'});
            list.push({'name':'K\'s Sandwiches', 'location': 'Mesa College', 'cuisine': 'Vietnamese'});
            list.push({'name':'Custcatlan Salvadorean', 'location': 'Mesa College', 'cuisine': 'Mexican'});
            list.push({'name':'Dim Sum', 'location': 'Convoy', 'cuisine': 'Chinese'});
            list.push({'name':'H-Mart Food Court', 'location': 'Convoy', 'cuisine': 'Korean'});
            list.push({'name':'Cross Street', 'location': 'Convoy', 'cuisine': 'Korean'});
            list.push({'name':'Popeyes', 'location': 'Convoy', 'cuisine': 'American'});
            list.push({'name':'Phuong Trang', 'location': 'Convoy', 'cuisine': 'Vietnamese'});
            list.push({'name':'Koon Thai', 'location': 'Convoy', 'cuisine': 'Thai'});
            list.push({'name':'Coco Ichibanya', 'location': 'Convoy', 'cuisine': 'Japanese'});
            list.push({'name':'Nishiki Ramen', 'location': 'Convoy', 'cuisine': 'Japanese'});
            list.push({'name':'Poki 1/2', 'location': 'Convoy', 'cuisine': 'Hawaiian'});
            list.push({'name':'Costco', 'location': 'Convoy', 'cuisine': 'American'});
            list.push({'name':'In N Out', 'location': 'Convoy', 'cuisine': 'American'});
            list.push({'name':'Katsu Cafe', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
            list.push({'name':'Ajisen Ramen', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
            list.push({'name':'Arby\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'Sam Woo', 'location': 'Clairemont Mesa', 'cuisine': 'Chinese'});
            list.push({'name':'PT Eatery', 'location': 'Clairemont Mesa', 'cuisine': 'Vietnamese'});
            list.push({'name':'Mom & Dom\'s Pizza', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'Rubio\'s', 'location': 'Clairemont Mesa', 'cuisine': 'Mexican'});
            list.push({'name':'Elijah\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'Ma\'s House', 'location': 'Clairemont Mesa', 'cuisine': 'Chinese'});
            list.push({'name':'Okan Diner', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
            list.push({'name':'Mister Falafel', 'location': 'Clairemont Mesa', 'cuisine': 'Mediterranean'});
            list.push({'name':'Main Chick', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'Chili\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'Domino\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'}); //duplicate
            list.push({'name':'Dino\'s Gyros', 'location': 'Clairemont Mesa', 'cuisine': 'Mediterranean'});
            list.push({'name':'McDonald\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
            list.push({'name':'McDonald\'s', 'location': 'Balboa', 'cuisine': 'American'}); //duplicate
            list.push({'name':'Taco Bell', 'location': 'Clairemont Mesa', 'cuisine': 'Mexican'});
            list.push({'name':'Taco Bell', 'location': 'Balboa', 'cuisine': 'Mexican'}); //duplicate
            list.push({'name':'Boston Market', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'Panera Bread', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'The Habit', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'Five Guys', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'Dickey\'s BBQ', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'Krispy Krunchy Chicken', 'location': 'Balboa', 'cuisine': 'American'});
            list.push({'name':'Thai Time', 'location': 'Balboa', 'cuisine': 'Thai'});
            list.push({'name':'Luna Grill', 'location': 'Balboa', 'cuisine': 'Mediterranean'});
            list.push({'name':'Vallarta\'s', 'location': 'Balboa', 'cuisine': 'Mexican'});
            list.push({'name':'Hawaiian Fresh Seafood', 'location': 'Mira Mesa', 'cuisine': 'Hawaiian'});
            list.push({'name':'Jollibee', 'location': 'Mira Mesa', 'cuisine': 'Filipino'});
            list.push({'name':'Grill City', 'location': 'Mira Mesa', 'cuisine': 'Filipino'});
            list.push({'name':'Raising Cane\'s', 'location': 'Mira Mesa', 'cuisine': 'American'});
            list.push({'name':'La Fuente', 'location': 'Other', 'cuisine': 'Mexican'});
            list.push({'name':'Ike\'s Sandwiches', 'location': 'Other', 'cuisine': 'American'});
            list.push({'name':'Wingstop', 'location': 'Other', 'cuisine': 'American'});
            list.push({'name':'In N Out', 'location': 'Other', 'cuisine': 'American'}); //duplicate
            //TODO what to do with duplicates?
        </script>

        <script type="text/javascript">
            //TODO clean up variable names?
            //if one of these arrays are empty, then that category will search through all
            var locationlist = [];
            var cuisinelist = [];

            function applyFiltersUI(){
                if(locationlist.length > 0 || cuisinelist.length > 0){
                    $('.btn-filter').removeClass('active');
                    for(var i=0; i < locationlist.length; i++){
                        document.getElementById(locationlist[i]).classList.add('active');
                    }
                    for(var i=0; i < cuisinelist.length; i++){
                        document.getElementById(cuisinelist[i]).classList.add('active');
                    }
                } else {
                    $('.btn-filter').removeClass('active');
                    $('.all').html('Select All');
                }
            }

            function createFilterArrays(){
                locationlist = []; //reset
                cuisinelist = []; //reset

                //first filter through locations if locations are selected
                var locations = $('.locations').children('.active');
                for(var j=0; j<locations.length; j++){
                    locationlist.push(locations[j].innerText);
                }

                //then filter through cuisines
                var cuisines = $('.cuisines').children('.active');
                for(var j=0; j<cuisines.length; j++){
                    cuisinelist.push(cuisines[j].innerText);
                }
            }

            function randomize(){
                $('#resultIcon').hide();
                $('#resultHolder').show();
                var newlist = [];

                //if filters are checked, narrow down options
                if(locationlist.length > 0 || cuisinelist.length > 0){
                    newlist = []; //reset list
                    for(var i=0; i<list.length; i++){
                        var templist = [];
                        if(locationlist.length > 0){
                            for(var j=0; j<locationlist.length; j++){
                                var temp = list.filter(function(obj) {
                                    return obj['location'] == locationlist[j];
                                });
                                templist = templist.concat(temp);
                            }
                        }
                        if(cuisinelist.length == 0){
                            newlist = templist;
                        } else {
                            for(var j=0; j<cuisinelist.length; j++){
                                if(templist.length > 0){ //further filter through options
                                    var temp = templist.filter(function(obj) {
                                        return obj['cuisine'] == cuisinelist[j];
                                    });
                                } else {
                                    var temp = list.filter(function(obj) {
                                        return obj['cuisine'] == cuisinelist[j];
                                    });
                                }
                                newlist = newlist.concat(temp);
                            }
                        }
                    }
                }
                //if no filters selected, do not filter
                if(newlist.length==0){
                    newlist = list;
                }

                //get a random result
                for (var i = 0; i < 100; i++) {
                    var delay = 1000*Math.pow(2, 10*(i/100-1))+0; //spins for 1000ms(1sec) then slows down and stops
                    setTimeout(function () {
                        var index = newlist.length;
                        index = Math.floor(Math.random()*index);
                        $('#result').html(newlist[index].name);
                        
                        //resize text if too long so it kinda stays centered
                        if($('#result').text().length > 20){
                            $('#result').css('font-size', 'calc(1.375rem + 0.1vw)');
                        } else {
                            $('#result').css('font-size', 'calc(1.375rem + 1.5vw)');
                        }
                    }, delay);

                    setTimeout(() => {$('#subtitle').html('Not feeling it?<br/>Tap to randomize again!')}, 3000);//shows message after 3 seconds
                }
            }

            function selectAll(button, category){
                if(button.innerText == 'Select All') {
                    $('.'+category+' label').addClass('active');
                    button.innerText = 'Clear All';
                } else {
                    $('.'+category+' label').removeClass('active');
                    button.innerText = 'Select All';
                }
            }

            function reset(){
                $('.btn-filter').removeClass('active');
                $('.all').html('Select All');
            }

            $(document).ready(function() {
                $('#startupModal').modal('show');
                $('#filtersModal').on('hide.bs.modal', function () {
                    applyFiltersUI();
                });
            });
        </script>
    </head>
    <body>
        <h1 id="filters-btn" data-toggle="modal" data-target="#filtersModal"><i class="fas fa-filter fa-xs"></i></h1>
        <div class="mainHolder">
            <h5 id="subtitle">Tap the icon below to pick a meal!</h5>
            <div id="randomize-btn" onclick="randomize();">
                <img id="resultIcon" src="https://image.flaticon.com/icons/png/512/179/179283.png">
                <div id="resultHolder" style="display:none;">
                    <h3>Let's eat</h3>
                    <h1 id="result"></h1>
                </div>
            </div>
        </div>
    </body>
</html>

<div class="modal" id="startupModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p>Happy Valentine's Day!</p>
        <p>Although we eat at Bud's every February 14th (or whenever it's open), I wanted to make us something to help us choose what to eat on other days of the year. So, this is a food randomizer for some of our favorite restaurants in San Diego! You can always filter by location or cuisine if we don't want to drive or if we're craving something specific. Enjoy!</p>
        <button type="button" class="btn" data-dismiss="modal">Begin</button>
      </div>
    </div>
  </div>
</div>

<!-- TODO im thinking i dont use bootstrap modals and do it myself with animations and everything -->
<div class="modal" id="filtersModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <span data-dismiss="modal" aria-label="Close">&larr;</span>
        <h3 style="margin-bottom:0;">Filters</h3>
        <a class="modal-title" onclick="reset();">Reset</a>
      </div>
      <div class="modal-body">
        <div class="filter-header"><h6>Locations</h6><a href="#" class="all" onclick="selectAll(this, 'locations');">Select All</a></div>
        <div class="btn-group-toggle locations" data-toggle="buttons">
          <label class="btn btn-filter" id="Mesa College"><input type="checkbox">Mesa College</label>
          <label class="btn btn-filter" id="Convoy"><input type="checkbox">Convoy</label>
          <label class="btn btn-filter" id="Clairemont Mesa"><input type="checkbox">Clairemont Mesa</label>
          <label class="btn btn-filter" id="Balboa"><input type="checkbox">Balboa</label>
          <label class="btn btn-filter" id="Mira Mesa"><input type="checkbox">Mira Mesa</label>
          <label class="btn btn-filter" id="Other"><input type="checkbox">Other</label>
        </div>

        <br />

        <div class="filter-header"><h6>Cuisines</h6><a href="#" class="all" onclick="selectAll(this, 'cuisines');">Select All</a></div>
        <div class="btn-group-toggle cuisines" data-toggle="buttons">
          <label class="btn btn-filter" id="Japanese"><input type="checkbox">Japanese</label>
          <label class="btn btn-filter" id="Korean"><input type="checkbox">Korean</label>
          <label class="btn btn-filter" id="Chinese"><input type="checkbox">Chinese</label>
          <label class="btn btn-filter" id="Vietnamese"><input type="checkbox">Vietnamese</label>
          <label class="btn btn-filter" id="Filipino"><input type="checkbox">Filipino</label>
          <label class="btn btn-filter" id="Thai"><input type="checkbox">Thai</label>
          <label class="btn btn-filter" id="Mexican"><input type="checkbox">Mexican</label>
          <label class="btn btn-filter" id="Hawaiian"><input type="checkbox">Hawaiian</label>
          <label class="btn btn-filter" id="Mediterranean"><input type="checkbox">Mediterranean</label>
          <label class="btn btn-filter" id="American"><input type="checkbox">American</label>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-dismiss="modal" onclick="createFilterArrays();">Apply</button>
      </div>
    </div>
  </div>
</div>