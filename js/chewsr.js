var list = [];
list.push({'name':'La Fuente', 'location': 'Serra Mesa', 'cuisine': 'Latin'});
list.push({'name':'Pick Up Stix', 'location': 'Serra Mesa', 'cuisine': 'Chinese'});
list.push({'name':'Rubio\'s', 'location': 'Serra Mesa', 'cuisine': 'Latin'});
list.push({'name':'Tahini', 'location': 'Serra Mesa', 'cuisine': 'Mediterranean'});
list.push({'name':'Lit\'l Pepper', 'location': 'Serra Mesa', 'cuisine': 'American'});
list.push({'name':'Village Indian Cuisine', 'location': 'Serra Mesa', 'cuisine': 'Indian'});
list.push({'name':'Sonic', 'location': 'Serra Mesa', 'cuisine': 'American'});
list.push({'name':'Homestyle Hawaiian', 'location': 'Mesa College', 'cuisine': 'Hawaiian'});
list.push({'name':'Domino\'s Pizza', 'location': 'Mesa College', 'cuisine': 'American'});
list.push({'name':'K\'s Sandwiches', 'location': 'Mesa College', 'cuisine': 'Vietnamese'});
list.push({'name':'Custcatlan Salvadorean', 'location': 'Mesa College', 'cuisine': 'Latin'});
list.push({'name':'Dim Sum', 'location': 'Convoy', 'cuisine': 'Chinese'});
list.push({'name':'H-Mart Food Court', 'location': 'Convoy', 'cuisine': 'Korean'});
list.push({'name':'Cross Street', 'location': 'Convoy', 'cuisine': 'Korean'});
list.push({'name':'Popeyes', 'location': 'Convoy', 'cuisine': 'American'});
list.push({'name':'Popeyes', 'location': 'Serra Mesa', 'cuisine': 'American'}); //duplicate
list.push({'name':'Phuong Trang', 'location': 'Convoy', 'cuisine': 'Vietnamese'});
list.push({'name':'Koon Thai', 'location': 'Convoy', 'cuisine': 'Thai'});
list.push({'name':'Coco Ichibanya', 'location': 'Convoy', 'cuisine': 'Japanese'});
list.push({'name':'Nishiki Ramen', 'location': 'Convoy', 'cuisine': 'Japanese'});
list.push({'name':'Poki 1/2', 'location': 'Convoy', 'cuisine': 'Hawaiian'});
list.push({'name':'Costco', 'location': 'Convoy', 'cuisine': 'American'});
list.push({'name':'Costco', 'location': 'Mission Valley', 'cuisine': 'American'});
list.push({'name':'Taco Stand', 'location': 'Convoy', 'cuisine': 'Latin'});
list.push({'name':'In N Out', 'location': 'Convoy', 'cuisine': 'American'});
list.push({'name':'In N Out', 'location': 'Mission Valley', 'cuisine': 'American'}); //duplicate
list.push({'name':'The Great Greek', 'location': 'Convoy', 'cuisine': 'Mediterranean'});
list.push({'name':'Katsu Cafe', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
list.push({'name':'Ajisen Ramen', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
list.push({'name':'Arby\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
list.push({'name':'Sam Woo', 'location': 'Clairemont Mesa', 'cuisine': 'Chinese'});
list.push({'name':'PT Eatery', 'location': 'Clairemont Mesa', 'cuisine': 'Vietnamese'});
list.push({'name':'Mom & Dom\'s Pizza', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
list.push({'name':'Rubio\'s', 'location': 'Clairemont Mesa', 'cuisine': 'Latin'});
list.push({'name':'Elijah\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
list.push({'name':'Ma\'s House', 'location': 'Clairemont Mesa', 'cuisine': 'Chinese'});
list.push({'name':'Okan Diner', 'location': 'Clairemont Mesa', 'cuisine': 'Japanese'});
list.push({'name':'Mister Falafel', 'location': 'Clairemont Mesa', 'cuisine': 'Mediterranean'});
list.push({'name':'Main Chick', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
list.push({'name':'Chaba Thai', 'location': 'Clairemont Mesa', 'cuisine': 'Thai'});
list.push({'name':'Chili\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'});
list.push({'name':'Domino\'s', 'location': 'Clairemont Mesa', 'cuisine': 'American'}); //duplicate
list.push({'name':'Dino\'s Gyros', 'location': 'Clairemont Mesa', 'cuisine': 'Mediterranean'});
list.push({'name':'McDonald\'s', 'location': 'Serra Mesa', 'cuisine': 'American'});
list.push({'name':'McDonald\'s', 'location': 'Balboa', 'cuisine': 'American'}); //duplicate
list.push({'name':'McDonald\'s', 'location': 'Serra Mesa', 'cuisine': 'American'}); //duplicate
list.push({'name':'Taco Bell', 'location': 'Clairemont Mesa', 'cuisine': 'Latin'});
list.push({'name':'Taco Bell', 'location': 'Balboa', 'cuisine': 'Latin'}); //duplicate
list.push({'name':'Taco Bell', 'location': 'Serra Mesa', 'cuisine': 'Latin'}); //duplicate
//list.push({'name':'Boston Market', 'location': 'Balboa', 'cuisine': 'American'}); //permanently closed
list.push({'name':'Panera Bread', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Panera Bread', 'location': 'Serra Mesa', 'cuisine': 'American'}); //duplicate
list.push({'name':'Panera Bread', 'location': 'Mission Valley', 'cuisine': 'American'}); //duplicate
list.push({'name':'Ikea', 'location': 'Mission Valley', 'cuisine': 'American'});
list.push({'name':'CAVA', 'location': 'Mission Valley', 'cuisine': 'Mediterranean'});
list.push({'name':'Wagyu Shawarma Grill', 'location': 'Mission Valley', 'cuisine': 'Mediterranean'});
list.push({'name':'The Cheesecake Factory', 'location': 'Mission Valley', 'cuisine': 'American'});
list.push({'name':'The Habit', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Five Guys', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Dickey\'s BBQ', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Krispy Krunchy Chicken', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Thai Time', 'location': 'Balboa', 'cuisine': 'Thai'});
list.push({'name':'Luna Grill', 'location': 'Balboa', 'cuisine': 'Mediterranean'});
list.push({'name':'Vallarta\'s', 'location': 'Balboa', 'cuisine': 'Latin'});
list.push({'name':'China Quick Wok', 'location': 'Balboa', 'cuisine': 'Chinese'});
list.push({'name':'Mike\'s Red Tacos', 'location': 'Balboa', 'cuisine': 'Latin'});
list.push({'name':'Chick-Fil-A', 'location': 'Balboa', 'cuisine': 'American'});
list.push({'name':'Chick-Fil-A', 'location': 'Mission Valley', 'cuisine': 'American'}); //duplicate
list.push({'name':'Hawaiian Fresh Seafood', 'location': 'Mira Mesa', 'cuisine': 'Hawaiian'});
list.push({'name':'Jollibee', 'location': 'Mira Mesa', 'cuisine': 'Filipino'});
list.push({'name':'Grill City', 'location': 'Mira Mesa', 'cuisine': 'Filipino'});
list.push({'name':'R&B Cuisine', 'location': 'Mira Mesa', 'cuisine': 'Filipino'});
list.push({'name':'Raising Cane\'s', 'location': 'Mira Mesa', 'cuisine': 'American'});
list.push({'name':'LouZiana', 'location': 'Mira Mesa', 'cuisine': 'American'});
list.push({'name':'Charminar', 'location': 'Mira Mesa', 'cuisine': 'Indian'});
list.push({'name':'Sushi Diner 2', 'location': 'Other', 'cuisine': 'Japanese'});
list.push({'name':'Ike\'s Sandwiches', 'location': 'Other', 'cuisine': 'American'});
list.push({'name':'Wingstop', 'location': 'Other', 'cuisine': 'American'});
list.push({'name':'CAVA', 'location': 'Other', 'cuisine': 'Mediterranean'}); //duplicate
list.push({'name':'Public Square Coffee', 'location': 'Other', 'cuisine': 'American'});
list.push({'name':'Pomegranate', 'location': 'Other', 'cuisine': 'Other'});
//TODO what to do with duplicates?

//TODO clean up variable names?
//if one of these arrays are empty, then that category will search through all
var locationlist = [];
var cuisinelist = [];

function applyFiltersUI(){
    if(locationlist.length > 0 || cuisinelist.length > 0){
        $('.btn-filter').removeClass('active');
        for(var i=0; i < locationlist.length; i++){
            document.getElementById(locationlist[i]).classList.add('active');
        }
        for(var i=0; i < cuisinelist.length; i++){
            document.getElementById(cuisinelist[i]).classList.add('active');
        }
    } else {
        $('.btn-filter').removeClass('active');
        $('.all').html('Select All');
    }
}

function createFilterArrays(){
    locationlist = []; //reset
    cuisinelist = []; //reset

    //first filter through locations if locations are selected
    var locations = $('.locations').children('.active');
    for(var j=0; j<locations.length; j++){
        locationlist.push(locations[j].innerText);
    }

    //then filter through cuisines
    var cuisines = $('.cuisines').children('.active');
    for(var j=0; j<cuisines.length; j++){
        cuisinelist.push(cuisines[j].innerText);
    }
    closeFilters();
}

function randomize(){
    $('#resultIcon').hide();
    $('#resultHolder').show();
    $('#no-options').hide();
    var newlist = [];

    //if filters are checked, narrow down options
    if(locationlist.length > 0 || cuisinelist.length > 0){
        newlist = []; //reset list
        for(var i=0; i<list.length; i++){
            var templist = [];
            if(locationlist.length > 0){
                for(var j=0; j<locationlist.length; j++){
                    var temp = list.filter(function(obj) {
                        return obj['location'] == locationlist[j];
                    });
                    templist = templist.concat(temp);
                }
            }
            if(cuisinelist.length == 0){
                newlist = templist;
            } else {
                for(var j=0; j<cuisinelist.length; j++){
                    if(templist.length > 0){ //further filter through options
                        var temp = templist.filter(function(obj) {
                            return obj['cuisine'] == cuisinelist[j];
                        });
                    } else {
                        var temp = list.filter(function(obj) {
                            return obj['cuisine'] == cuisinelist[j];
                        });
                    }
                    newlist = newlist.concat(temp);
                }
            }
        }
        //if filters are checked but there are no available options from those filters
        if(newlist.length==0){
            newlist.push({'name':'Leftovers :)'});
            $('#no-options').show();
        }
    }
    //if no filters selected, do not filter
    if(newlist.length==0){
        newlist = list;
    }

    //get a random result
    for (var i = 0; i < 100; i++) {
        var delay = 1000*Math.pow(2, 10*(i/100-1))+0; //spins for 1000ms(1sec) then slows down and stops
        setTimeout(function () {
            var index = newlist.length;
            index = Math.floor(Math.random()*index);
            $('#result').html(newlist[index].name);
            
            //resize text if too long so it kinda stays centered
            if($('#result').text().length > 20){
                $('#result').css('font-size', 'calc(1.375rem + 0.1vw)');
            } else {
                $('#result').css('font-size', 'calc(1.375rem + 1.5vw)');
            }
        }, delay);

        setTimeout(() => {$('#subtitle').html('Not feeling it?<br/>Tap to randomize again!')}, 3000);//shows message after 3 seconds
    }
}

function selectAll(button, category){
    if(button.innerText == 'Select All') {
        $('.'+category+' label').addClass('active');
        button.innerText = 'Clear All';
    } else {
        $('.'+category+' label').removeClass('active');
        button.innerText = 'Select All';
    }
}

function reset(){
    $('.btn-filter').removeClass('active');
    $('.all').html('Select All');
}

function openFilters(){
    var resposivewindow = window.matchMedia('(max-width: 1024px)');
    if(resposivewindow.matches){
        $('#filtersHolder').css('left', '0');
    } else {
        $('#filtersHolder').css('left', '1000px');
    }
    $('#filtersHolder').show();
}

function closeFilters(){
    $('#filtersHolder').css('left', '2000px');
    applyFiltersUI();
}

$(document).ready(function() {
    //display message on page load
    //$('#startupModal').modal('show');

    //creates human readable list from js array
    var serra = '';
    var college = '';
    var convoy = '';
    var mission = '';
    var clairemont = '';
    var balboa = '';
    var mira = '';
    var other = '';
    for(var i=0; i<list.length; i++){
        switch(list[i].location){
            case 'Serra Mesa':
                if(serra.length == 0) serra = list[i].name;
                else serra = serra + ', ' + list[i].name;
                break;
            case 'Mesa College':
                if(college.length == 0) college = list[i].name;
                else college = college + ', ' + list[i].name;
                break;
            case 'Convoy':
                if(convoy.length == 0) convoy = list[i].name;
                else convoy = convoy + ', ' + list[i].name;
                break;
            case 'Mission Valley':
                if(mission.length == 0) mission = list[i].name;
                else mission = mission + ', ' + list[i].name;
                break;
            case 'Clairemont Mesa':
                if(clairemont.length == 0) clairemont = list[i].name;
                else clairemont = clairemont + ', ' + list[i].name;
                break;
            case 'Balboa':
                if(balboa.length == 0) balboa = list[i].name;
                else balboa = balboa + ', ' + list[i].name;
                break;
            case 'Mira Mesa':
                if(mira.length == 0) mira = list[i].name;
                else mira = mira + ', ' + list[i].name;
                break;
            case 'Other':
                if(other.length == 0) other = list[i].name;
                else other = other + ', ' + list[i].name;
                break;
        }
    }
    var data = '<br/><h6>Serra Mesa</h6>'
                    + serra
                + '<br/><br/><h6>Mesa College</h6>'
                    + college
                + '<br/><br/><h6>Convoy</h6>'
                    + convoy
                + '<br/><br/><h6>Mission Valley</h6>'
                    + mission
                + '<br/><br/><h6>Clairemont Mesa</h6>'
                    + clairemont
                + '<br/><br/><h6>Balboa</h6>'
                    + balboa
                + '<br/><br/><h6>Mira Mesa</h6>'
                    + mira
                + '<br/><br/><h6>Other Places</h6>'
                    + other;
    var listHolder = $('#readableList').find('.dynamic-add');
    listHolder.prepend(data);
});
